[gapps:report:login]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)
# Should be 2015-11-11T14:56:17.875Z
EVAL-vendor = "GSuite"
FIELDALIAS-sig = events{}.parameters{}.login_type AS signature
FIELDALIAS-user = actor.email AS user
EVAL-app = "GSuite login"
FIELDALIAS-authentication_method = "events{}.parameters{}.multiValue{}" ASNEW authentication_method
FIELDALIAS-source = ipAddress ASNEW src
FIELDALIAS-user_id = "actor.email" ASNEW user_id
FIELDALIAS-type = "events{}.type" ASNEW signature
EVAL-action = case('events{}.name'="login_success","success",'events{}.name'="login_failure","failure",'events{}.name'="login_challenge","challenge",'events{}.name'="logout","logout",'events{}.name'="suspicious_login","suspicious_login")

[gapps:report:token]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)
FIELDALIAS-actor_email = actor.email AS user
EVAL-vendor = "GSuite"
EVAL-app = "GSuite token"
# Should be 2015-11-11T14:56:17.875Z

[gapps:report:calendar]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)
# Should be 2015-11-11T14:56:17.875Z
EVAL-vendor = "GSuite"
EVAL-app = "GSuite calendar"
FIELDALIAS-user = actor.email AS user
FIELDALIAS-cat = events{}.type AS category
FIELDALIAS-name = events{}.name AS event_name
EVAL-action = case(match(event_name,"add") OR match(event_name,"change") OR match(event_name,"remove") OR match(event_name,"restore"),"modified",match(event_name,"delete"),"deleted",match(event_name,"create"),"created",match(event_name,"triggered"),"trigger",true(),"unknown")
EVAL-event_id = 'events{}.parameters{}.event_id'
EVAL-start_time = 'events{}.parameters{}.start_time'
EVAL-end_time = 'events{}.parameters{}.end_time'

[gapps:report:admin]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
# Should be 2015-11-11T14:56:17.875Z
EVAL-vendor = "GSuite"
EVAL-app = "GSuite admin"
FIELDALIAS-user = actor.email AS user
EVAL-domain = mvindex(split(source,":"),-1)
FIELDALIAS-ipAddr = ipAddress AS src
FIELDALIAS-change_type = events{}.type AS change_type
FIELDALIAS-name = events{}.name AS command
FIELDALIAS-old = events{}.parameters{}.OLD_VALUE AS old_value
FIELDALIAS-new = events{}.parameters{}.NEW_VALUE AS new_value
FIELDALIAS-vendor_account = id.customerId ASNEW vendor_account
FIELDALIAS-src_ip = ipAddress ASNEW src_ip
FIELDALIAS-user_agent = kind ASNEW user_agent
EVAL-action = case(match(command,"CREATE"),"created",match(command,"DELETE") ,"deleted",match(command,"ADD") OR match(command,"REMOVE") OR match(command,"UNSUSPEND") OR match(command,"SUSPEND") OR match(command,"CHANGE") OR match(command,"TOGGLE"),"modified",command="SECURITY_CHART_DRILLDOWN","read",match(command,"UPDATE"),"updated", true(),"unknown")


[gapps:report:drive]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-size = metadata.size as bytes
EVAL-vendor = "GSuite"
EVAL-app = "GSuite drive"
FIELDALIAS-user = actor.email AS user
EVAL-domain = mvindex(split(source,":"),-1)
FIELDALIAS-cat = events{}.type AS category
FIELDALIAS-object = events{}.parameters{}.doc_id AS object
FIELDALIAS-ipadd = ipAddress AS src
FIELDALIAS-name = events{}.name AS event_name
EVAL-action = case(event_name="change_acl_editors" OR event_name="change_document_access_scope" OR event_name="change_user_access","acl_modified",event_name="create" OR event_name="upload","created",event_name="edit" OR event_name="rename" OR event_name="move" OR event_name="untrash" OR event_name="add_to_folder","modified",event_name="download" OR event_name="view" ,"read", event_name="trash","deleted",true(),"unknown")
FIELDALIAS-meta = metadata.*.* AS object_attrs_*_*

[gapps:report:mobile]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
EVAL-vendor = "GSuite"
EVAL-app = "GSuite mobile"
FIELDALIAS-user = actor.email AS user
EVAL-domain = mvindex(split(source,":"),-1)
FIELDALIAS-cat = events{}.type AS category
FIELDALIAS-action = events{}.name AS action
FIELDALIAS-serial = events{}.parameters{}.SERIAL_NUMBER AS serial
FIELDALIAS-family = events{}.parameters{}.DEVICE_TYPE as family
EVAL-os = events{}.parameters{}.DEVICE_MODEL ." ".events{}.parameters{}.DEVICE_TYPE

[gapps:report:groups]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
EVAL-vendor = "GSuite"
EVAL-app = "GSuite groups"
FIELDALIAS-user = actor.email AS user
EVAL-domain = mvindex(split(source,":"),-1)
FIELDALIAS-ipAddr = ipAddress AS src
FIELDALIAS-name = events{}.name AS event_name
EVAL-action = case(event_name="change_acl_permission","acl_modified",match(event_name,"add") OR match(event_name,"remove") OR match(event_name, "change") OR match(event_name,"invite") OR match(event_name,"accept"),"modified", match(event_name,"create"),"created",match(event_name,"delete"),"deleted",true(),"unknown")
FIELDALIAS-object = events{}.parameters{}.group_email AS object


[gapps:report:rules]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:report:saml]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:report:chat]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:report:gplus]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
FIELDALIAS-ipAddr = ipAddress AS src
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:usage:user]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
EVAL-domain = mvindex(split(source,":"),-1)
# Should be 2015-11-11T14:56:17.875Z

[gapps:usage:chrome]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
# Should be 2015-11-11T14:56:17.875Z
EVAL-vendor = "GSuite"
EVAL-app = "GSuite chrome os devices"
FIELDALIAS-user = annotatedUser AS user
FIELDALIAS-mac = macAddress AS mac
FIELDALIAS-serial = serialNumber AS serial
FIELDALIAS-version = osVersion AS os
FIELDALIAS-family = firmwareVersion AS family
EVAL-os = model ." ".platformVersion

[gapps:usage:customer]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:report:docs]
#REPORT-gappsjson = gapps_ext_json
KV_MODE = json
## Updated to fix ASA-2
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "time":
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TZ = UTC
# Should be 2015-11-11T14:56:17.875Z

[google:analytics:report]
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%:z
TIME_PREFIX = ga_dimension_dimension5="
MAX_TIMESTAMP_LOOKAHEAD = 35
disabled = false
pulldown_type = true

[source::...modularinput.log]
sourcetype = ga_modularinput

[ga_modularinput]
EXTRACT-msg =  "exception_arguments":\s"(?<message>[^"]+)"
EXTRACT-ln = "line":\s(?<exception_line>\d+)

[source::...restclient.log]
sourcetype = ga_restclient

[source::...ga_utilities.log]
sourcetype = utilities

[source::...ga_authorize_controller.log]
sourcetype = ga_authorize_controller

[source::..ga_authorize_endpoint.log]
sourcetype = ga_authorize_endpoint

[source::...ga_spreadsheets_endpoint.log]
sourcetype = ga_spreadsheets_endpoint

[source::...ga_ss_modular_input.log]
sourcetype = ga_ss_modularinput

[source::...modularinput_bigquery.log]
sourcetype = ga_bigquery_modularinput

[google:bigquery:table]
EVAL-app = "bigquery"
TIME_PREFIX = timestamp":
MAX_TIMESTAMP_LOOKAHEAD = 35
# Super Big Thanks to jcooperFossil for providing these extractions
EVAL-action = case(message_spam="true" OR action_id="19","quarantined",action_id="2" OR action_id="3" ,"delivered")
EVAL-duration = (duration/pow(10,6))
EVAL-retries = if('message_info.action_type'="18" OR 'message_info.action_type'="14"  , "true", "false")
EVAL-vendor_product = "BigQuery"
EVAL-vendor = "Google"
EVAL-recipient_count =  mvcount(split('message_info.flattened_destinations',","))
FIELDALIAS-aob_gen_gmail_alias_01 = event_info.elapsed_time_usec AS duration
FIELDALIAS-aob_gen_gmail_alias_02 = message_info.action_type AS action_id
FIELDALIAS-aob_gen_gmail_alias_03 = message_info.rfc2822_message_id AS message_id
FIELDALIAS-aob_gen_gmail_alias_04 = message_info.attachment{}.sha256 AS file_hash
FIELDALIAS-aob_gen_gmail_alias_05 = message_info.attachment{}.file_extension_type AS file_name
FIELDALIAS-aob_gen_gmail_alias_06 = message_info.connection_info.client_ip AS src
FIELDALIAS-aob_gen_gmail_alias_07 = message_info.destination{}.address AS recipient
FIELDALIAS-aob_gen_gmail_alias_08 = message_info.source.address AS src_user
FIELDALIAS-aob_gen_gmail_alias_09 = message_info.subject AS subject
FIELDALIAS-aob_gen_gmail_alias_10 = message_info.payload_size AS file_size
FIELDALIAS-aob_gen_gmail_alias_11 = message_info.connection_info.smtp_reply_code AS status_code
FIELDALIAS-aob_gen_gmail_alias_12 = message_info.source.from_header_displayname AS user
FIELDALIAS-aob_gen_gmail_alias_13 = message_info.payload_size AS size
FIELDALIAS-aob_gen_gmail_alias_14 = message_info.upload_error_category AS upload_error_code
FIELDALIAS-aob_gen_gmail_alias_15 = message_info.is_spam AS message_spam
FIELDALIAS-aob_gen_gmail_alias_16 = message_info.spam_info.classification_reason AS message_info_id
LOOKUP-gmail_sign_ID = gmail_sign id AS action_id OUTPUTNEW signature AS filter_action
LOOKUP-gmail_code_lookup = gmail_code_lookup code AS status_code  OUTPUTNEW recipient_status
LOOKUP-gmail_info = gmail_info_lookup message_info_id OUTPUTNEW signature

[gapps:report:meet]
KV_MODE = json
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
EVAL-domain = mvindex(split(source,":"),-1)
EVAL-event_name = 'events{}.name'
EVAL-device_type = 'events{}.parameters{}.device_type'
EVAL-conference_id = 'events{}.parameters{}.conference_id'
EVAL-display_name = 'events{}.parameters{}.display_name'
EVAL-duration_seconds = 'events{}.parameters{}.duration_seconds'
EVAL-parameters_name = 'events{}.parameters{}.name'
EVAL-location_country = 'events{}.parameters{}.location_country'
EVAL-location_region = 'events{}.parameters{}.location_region'
EVAL-calendar_event_id = 'events{}.parameters{}.calendar_event_id'
EVAL-participant_id = 'events{}.parameters{}.identifier'
EVAL-participant_type = case('actor.callerType'="USER","Internal",'actor.callerType'="KEY","External")
EVAL-participant_ip_address = 'events{}.parameters{}.ip_address'

[gapps:classroom:courses]
KV_MODE = json
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
EVAL-domain = mvindex(split(source,":"),-1)

[gapps:classroom:aliases]
KV_MODE = json
MAX_TIMESTAMP_LOOKAHEAD = 50
TIME_PREFIX = "timestamp":
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TRUNCATE = 0
EVAL-domain = mvindex(split(source,":"),-1)